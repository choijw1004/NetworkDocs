# Link Layer

링크 계층은 물리 계층과 네트워크 계층 사이에서 데이터 전송 단위인 프레임으로 캡슐화 및 해체되는 과정을 담당

---

## MAC (Medium Access Control)

MAC은 데이터 링크 계층에서 물리 매체에 접근하는 규칙과 방법을 정의  
프레임을 구성해 상위 네트워크 계층의 패킷을 캡슐화하며, 하드웨어 주소(MAC 주소)를 사용해 목적지 장치를 식별

### MAC 주소

네트워크 인터페이스에 할당된 고유 식별자  
주로 48비트로 구성 (예: 00:1A:2B:3C:4D:5E)  
스위치나 브리지는 이 MAC 주소를 기반으로 프레임 전달 경로 결정

### 프레임 캡슐화 및 해체 과정

- **프레임 캡슐화**  
  상위 네트워크 계층에서 전달받은 패킷의 헤더와 데이터를 MAC 프레임의 페이로드로 삽입  
  프레임 헤더에는 출발지 및 목적지 MAC 주소, 타입/길이 필드 등이 포함됨

- **프레임 해체**  
  수신 측에서 프레임의 헤더를 분석해 MAC 주소와 타입 필드를 확인  
  프레임에서 캡슐화된 패킷을 추출한 후 네트워크 계층으로 전달

### MAC 프로토콜 및 접근 방식

여러 매체 접근 기법 존재

- **TDMA (Time Division Multiple Access)**  
  시간 슬롯 분할 방식, 미사용 슬롯 발생 시 자원 낭비 우려

- **FDMA (Frequency Division Multiple Access)**  
  주파수 대역 분할 방식, 여러 사용자가 동시에 통신 가능

- **Random Access Protocols**  
  - **CSMA (Carrier Sense Multiple Access)**  
    전송 전 채널 상태 확인, 충돌 가능성 감소 시도  
    - **CSMA/CD (Collision Detection)**  
      충돌 감지 후 이진 지수 백오프로 재전송 시도
  - **Taking Turns MAC Protocols**  
    전송 순서 정해 데이터 전송, 단일 장애 지점에 취약할 수 있음

### MAC 스위칭 및 브리징

스위치와 브리지는 프레임 내 MAC 주소를 읽어 목적지 결정  
프레임 캡슐화 과정에서 생성된 헤더 정보 활용해 올바른 포트로 전달  
네트워크 세그먼트 분리 및 트래픽 관리에 중요한 역할

---

## ARP (Address Resolution Protocol)

ARP는 네트워크 계층의 IP 주소와 데이터 링크 계층의 MAC 주소 간 매핑 정보를 제공  
로컬 네트워크 내에서 IP 패킷을 전달하기 위한 필수 과정

### ARP 동작 및 프레임 처리 과정

- **ARP 요청 전송**  
  호스트가 자신이 전송하려는 IP 패킷의 목적지 MAC 주소를 모를 경우  
  ARP 요청 메시지를 브로드캐스트 프레임으로 캡슐화하여 전송  
  프레임 헤더에는 발신 MAC 주소와 브로드캐스트 목적지(FF:FF:FF:FF:FF:FF) 포함

- **ARP 응답 수신**  
  요청받은 장치가 자신의 IP와 대응하는 MAC 주소를 ARP 응답 메시지에 담아 전송  
  응답은 일반적으로 단일 호스트로 전달되며, 프레임 헤더에 발신 MAC 주소와 요청을 보낸 호스트의 MAC 주소가 포함

- **ARP 캐시 갱신**  
  수신 측에서는 프레임의 ARP 응답에서 MAC 주소를 추출해  
  IP 주소와 MAC 주소 매핑 정보를 캐시에 저장하여 향후 프레임 캡슐화 시 재사용

### 프레임과 패킷 해체

ARP 응답 프레임 수신 시  
프레임의 헤더와 페이로드를 분리해 ARP 메시지 분석  
ARP 메시지 내부에 있는 IP와 MAC 주소 정보를 이용해 상위 네트워크 계층의 전달 경로 결정

---

## 추가적으로 알아야 할 링크 계층 개념

- **프레이밍 (Framing)**  
  네트워크 계층의 패킷을 링크 계층 프레임으로 캡슐화  
  동기화 정보, 주소, 제어 및 에러 검출 정보를 포함한 헤더 생성

- **에러 검출 및 수정**  
  CRC (Cyclic Redundancy Check) 등의 기법을 이용해 전송 중 오류 확인  
  오류 발생 시 상위 계층에서 재전송 요청

- **플로우 제어 (Flow Control)**  
  송신자와 수신자 간 데이터 전송 속도 조절  
  네트워크 과부하 방지 목적

- **VLAN (Virtual LAN)**  
  물리적 네트워크를 논리적으로 분할해 보안 및 트래픽 관리 강화

- **Spanning Tree Protocol (STP)**  
  네트워크 루프 방지 위해 경로 자동 구성, 다중 경로 문제 해결

- **링크 어그리게이션 (Link Aggregation)**  
  여러 물리적 링크를 하나의 논리적 링크로 결합해 대역폭 확장 및 신뢰성 향상

- **QoS (Quality of Service) 지원**  
  트래픽 우선순위 지정으로 네트워크 혼잡 상황에서도 중요 데이터 우선 처리

- **무선 링크 고려사항**  
  무선 네트워크에서 간섭, 페이딩, 이동성 등의 문제 해결 위한 전용 메커니즘 존재 (예 IEEE 802.11)
